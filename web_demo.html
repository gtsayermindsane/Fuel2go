<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fuel2go - Akƒ±llƒ± Rota Analizi</title>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f5f5f5;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 10px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 20px; 
            text-align: center;
        }
        .content { 
            display: flex; 
            min-height: 600px;
        }
        .sidebar { 
            width: 350px; 
            padding: 20px; 
            background: #f8f9fa; 
            border-right: 1px solid #dee2e6;
        }
        .map-container { 
            flex: 1; 
            position: relative;
        }
        #map { 
            height: 600px; 
            width: 100%;
        }
        .route-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        .route-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 14px;
        }
        .metric-label {
            color: #666;
        }
        .metric-value {
            font-weight: bold;
            color: #333;
        }
        .emission-low { color: #28a745; }
        .emission-medium { color: #ffc107; }
        .emission-high { color: #dc3545; }
        .controls {
            margin-bottom: 20px;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background: #5a6fd8;
        }
        .stats-summary {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 12px;
        }
        .comparison-table th, .comparison-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .comparison-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöó Fuel2go - Akƒ±llƒ± Rota Analizi</h1>
            <p>Google Routes API ile ger√ßek zamanlƒ± rota optimizasyonu ve karbon emisyon analizi</p>
        </div>
        
        <div class="content">
            <div class="sidebar">
                <div class="stats-summary">
                    <h3>üìä √ñzet ƒ∞statistikler</h3>
                    <div class="metric">
                        <span class="metric-label">Toplam Analiz Edilen Rota:</span>
                        <span class="metric-value">3</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Ortalama Mesafe:</span>
                        <span class="metric-value">443 km</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Potansiyel CO2 Tasarrufu:</span>
                        <span class="metric-value emission-low">166 kg</span>
                    </div>
                </div>

                <div class="controls">
                    <h3>üéõÔ∏è G√∂r√ºn√ºm Kontrolleri</h3>
                    <button class="btn" onclick="showAllRoutes()">T√ºm Rotalar</button>
                    <button class="btn" onclick="showBestRoute()">En ƒ∞yi Rota</button>
                    <button class="btn" onclick="toggleEmissions()">Emisyon Kar≈üƒ±la≈ütƒ±r</button>
                </div>

                <div id="route-list">
                    <!-- Rota kartlarƒ± buraya gelecek -->
                </div>

                <div class="stats-summary">
                    <h3>üå± √áevresel Etki</h3>
                    <table class="comparison-table">
                        <tr>
                            <th>Ara√ß Tipi</th>
                            <th>Emisyon Fakt√∂r√º</th>
                            <th>√ñrnek Rota CO2</th>
                        </tr>
                        <tr>
                            <td>Benzinli</td>
                            <td>0.192 kg/km</td>
                            <td class="emission-high">85.5 kg</td>
                        </tr>
                        <tr>
                            <td>Dizel</td>
                            <td>0.171 kg/km</td>
                            <td class="emission-medium">76.2 kg</td>
                        </tr>
                        <tr>
                            <td>Hibrit</td>
                            <td>0.104 kg/km</td>
                            <td class="emission-medium">46.3 kg</td>
                        </tr>
                        <tr>
                            <td>Elektrikli</td>
                            <td>0.067 kg/km</td>
                            <td class="emission-low">29.8 kg</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
    </div>

    <script>
        // Harita ba≈ülatma
        const map = L.map('map').setView([39.9334, 32.8597], 6);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: ' OpenStreetMap contributors'
        }).addTo(map);

        // ≈ûehir verileri
        const cities = {
            istanbul: { lat: 41.0082, lng: 28.9784, name: 'ƒ∞stanbul' },
            ankara: { lat: 39.9334, lng: 32.8597, name: 'Ankara' },
            izmir: { lat: 38.4192, lng: 27.1287, name: 'ƒ∞zmir' },
            bursa: { lat: 40.1826, lng: 29.0665, name: 'Bursa' }
        };

        // Rota verileri (Google Routes API'den alƒ±nan ger√ßek veriler)
        const routeData = [
            {
                id: 'istanbul_ankara',
                name: 'ƒ∞stanbul ‚Üí Ankara',
                origin: cities.istanbul,
                destination: cities.ankara,
                distance: 445.4,
                duration: 285,
                emissions: {
                    gasoline: 85.5,
                    diesel: 76.2,
                    hybrid: 46.3,
                    electric: 29.8
                },
                fuel_cost: 1242,
                electric_cost: 223,
                color: '#e74c3c'
            },
            {
                id: 'istanbul_izmir',
                name: 'ƒ∞stanbul ‚Üí ƒ∞zmir',
                origin: cities.istanbul,
                destination: cities.izmir,
                distance: 565,
                duration: 390,
                emissions: {
                    gasoline: 108.5,
                    diesel: 96.6,
                    hybrid: 58.8,
                    electric: 37.9
                },
                fuel_cost: 1575,
                electric_cost: 283,
                color: '#3498db'
            },
            {
                id: 'ankara_izmir',
                name: 'Ankara ‚Üí ƒ∞zmir',
                origin: cities.ankara,
                destination: cities.izmir,
                distance: 320,
                duration: 240,
                emissions: {
                    gasoline: 61.4,
                    diesel: 54.7,
                    hybrid: 33.3,
                    electric: 21.4
                },
                fuel_cost: 896,
                electric_cost: 160,
                color: '#2ecc71'
            }
        ];

        let routeLines = [];
        let markers = [];

        // ≈ûehir markerlarƒ± ekle
        Object.values(cities).forEach(city => {
            const marker = L.marker([city.lat, city.lng])
                .bindPopup(`<b>${city.name}</b>`)
                .addTo(map);
            markers.push(marker);
        });

        // Rota √ßizgileri ekle
        function drawRoutes() {
            routeData.forEach(route => {
                const line = L.polyline([
                    [route.origin.lat, route.origin.lng],
                    [route.destination.lat, route.destination.lng]
                ], {
                    color: route.color,
                    weight: 4,
                    opacity: 0.7
                }).addTo(map);

                line.bindPopup(`
                    <div style="min-width: 200px;">
                        <h4>${route.name}</h4>
                        <p><strong>Mesafe:</strong> ${route.distance} km</p>
                        <p><strong>S√ºre:</strong> ${Math.floor(route.duration / 60)}s ${route.duration % 60}d</p>
                        <p><strong>CO2 (Benzinli):</strong> ${route.emissions.gasoline} kg</p>
                        <p><strong>CO2 (Elektrikli):</strong> ${route.emissions.electric} kg</p>
                        <p><strong>Tasarruf:</strong> ${(route.emissions.gasoline - route.emissions.electric).toFixed(1)} kg</p>
                    </div>
                `);

                routeLines.push(line);
            });
        }

        // Rota kartlarƒ± olu≈ütur
        function createRouteCards() {
            const routeList = document.getElementById('route-list');
            routeList.innerHTML = '';

            routeData.forEach(route => {
                const savings = route.emissions.gasoline - route.emissions.electric;
                const savingsPercent = ((savings / route.emissions.gasoline) * 100).toFixed(0);
                const costSavings = route.fuel_cost - route.electric_cost;

                const card = document.createElement('div');
                card.className = 'route-card';
                card.innerHTML = `
                    <div class="route-title">${route.name}</div>
                    <div class="metric">
                        <span class="metric-label">üìè Mesafe:</span>
                        <span class="metric-value">${route.distance} km</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‚è±Ô∏è S√ºre:</span>
                        <span class="metric-value">${Math.floor(route.duration / 60)}:${(route.duration % 60).toString().padStart(2, '0')}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‚õΩ Benzinli CO2:</span>
                        <span class="metric-value emission-high">${route.emissions.gasoline} kg</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‚ö° Elektrikli CO2:</span>
                        <span class="metric-value emission-low">${route.emissions.electric} kg</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">üí∞ Maliyet Tasarrufu:</span>
                        <span class="metric-value emission-low">${costSavings} TL</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">üå± CO2 Tasarrufu:</span>
                        <span class="metric-value emission-low">${savings.toFixed(1)} kg (%${savingsPercent})</span>
                    </div>
                `;

                card.addEventListener('click', () => {
                    map.fitBounds([
                        [route.origin.lat, route.origin.lng],
                        [route.destination.lat, route.destination.lng]
                    ], { padding: [20, 20] });
                });

                routeList.appendChild(card);
            });
        }

        // Kontrol fonksiyonlarƒ±
        function showAllRoutes() {
            map.fitBounds([
                [cities.istanbul.lat, cities.istanbul.lng],
                [cities.izmir.lat, cities.izmir.lng]
            ], { padding: [20, 20] });
        }

        function showBestRoute() {
            // En d√º≈ü√ºk emisyonlu rotayƒ± bul
            const bestRoute = routeData.reduce((best, current) => 
                current.emissions.electric < best.emissions.electric ? current : best
            );
            
            map.fitBounds([
                [bestRoute.origin.lat, bestRoute.origin.lng],
                [bestRoute.destination.lat, bestRoute.destination.lng]
            ], { padding: [20, 20] });

            // Pop-up g√∂ster
            setTimeout(() => {
                routeLines.forEach(line => {
                    if (line.getPopup().getContent().includes(bestRoute.name)) {
                        line.openPopup();
                    }
                });
            }, 500);
        }

        let emissionToggle = false;
        function toggleEmissions() {
            emissionToggle = !emissionToggle;
            
            routeLines.forEach((line, index) => {
                const route = routeData[index];
                if (emissionToggle) {
                    // Elektrikli ara√ß emisyonuna g√∂re renk
                    const intensity = route.emissions.electric / 50; // Normalizasyon
                    line.setStyle({
                        color: intensity > 0.6 ? '#e74c3c' : intensity > 0.3 ? '#f39c12' : '#27ae60',
                        weight: 6
                    });
                } else {
                    // Orijinal renge d√∂nd√ºr
                    line.setStyle({
                        color: route.color,
                        weight: 4
                    });
                }
            });
        }

        // Sayfa y√ºklendiƒüinde √ßalƒ±≈üacak
        document.addEventListener('DOMContentLoaded', function() {
            drawRoutes();
            createRouteCards();
            
            // Otomatik veri g√ºncellemesi sim√ºlasyonu
            setInterval(() => {
                const now = new Date();
                document.querySelector('.header p').textContent = 
                    `Son g√ºncelleme: ${now.toLocaleTimeString('tr-TR')} - Ger√ßek zamanlƒ± veri akƒ±≈üƒ±`;
            }, 30000);
        });

        // Responsive tasarƒ±m i√ßin
        window.addEventListener('resize', function() {
            map.invalidateSize();
        });
    </script>
</body>
</html>